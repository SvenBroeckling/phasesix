{% load characters_extras %}
{% load i18n %}
{% load portal_extras %}

<div class="list-group mb-3">

  <div data-sidebar-title="{% trans 'Character' %}"
       data-sidebar-url="{% url 'characters:xhr_character_sidebar' pk=object.id sidebar_template="character" %}"
       class="sidebar-trigger list-group-item p-0 overflow-hidden border-bottom-0"
       style="background-image: url('{% character_backdrop_image_url object geometry='600x160' %}');
               background-repeat: no-repeat;
               background-position: center;
               height: 80px;
               min-height: 100%;
               background-size: cover;">
  </div>

  <div data-sidebar-title="{% trans 'Character' %}"
       data-sidebar-url="{% url 'characters:xhr_character_sidebar' pk=object.id sidebar_template="character" %}"
       class="py-3 navigation-link sidebar-trigger navigation-link pointer list-group-item list-group-item-action d-flex flex-column text-center justify-content-center align-items-center"
       aria-current="true">

    <div class="d-flex align-items-center hover-pointer"
         style="position:absolute; left:calc(50% -40px); top:-60px">
      <img width="84" height="84" class="border border-2 border-black"
           src="{% character_image_url object geometry="160x160" %}"
           alt="{% trans "Profile image" %}">
    </div>

    <div class="mt-3 d-flex align-items-center flex-column justify-content-center">
      {% if object.first_name or object.last_name %}
        <span class="fw-bold">{{ object.first_name }} {{ object.last_name }}</span>
      {% else %}
        <span class="fw-bold">{{ object|capfirst }}</span>
      {% endif %}
      <span class="small opacity-75 lh-sm">{{ object.description|default:"" }}</span>
    </div>
  </div>
</div>

<ul class="list-group mb-3">
  <li class="list-group-item">
    <i class="fas fa-fw fa-hourglass text-info" data-bs-toggle="popover" data-bs-trigger="hover"
       title="{% trans 'Actions' %}"
       data-bs-content="{% trans 'The amount of actions you can use in combat.' %}"></i>
    {% trans 'Combat Actions' %}
    <span class="float-end">{% color_value_span object.actions 4 %}</span></li>
  <li class="list-group-item">
    <i class="fas fa-fw fa-dice-five text-warning" data-bs-toggle="popover"
       title="{% trans 'Minimum Roll' %}"></i>
    {% trans 'Minimum Roll' %}
    <span class="float-end">{% color_value_span object.minimum_roll 5 invert=True %}+</span>
  </li>
</ul>

{% detail_fragment "status" %}

<div class="list-group mb-3">
  <a class="active navigation-link pointer py-3 list-group-item list-group-item-action d-flex justify-content-between align-items-center"
     data-bs-toggle="tab"
     data-bs-target="#v-character"
     role="tab"
     aria-current="true">
    <div class="d-flex justify-content-center align-items-center">
      <i class="fas fa-fw fa-male"></i>
      <span class="ms-3 d-block d-lg-block">{% trans "Character" %}</span>
    </div>
  </a>

  <a class="py-3 navigation-link pointer list-group-item list-group-item-action d-flex justify-content-between align-items-center"
     data-bs-toggle="tab"
     data-bs-target="#v-gear"
     role="tab"
     aria-current="false">
    <div class="d-flex justify-content-center align-items-center">
      <i class="fas fa-fw fa-suitcase"></i>
      <span class="ms-3 d-block d-lg-block">{% trans "Gear" %}</span>
    </div>
  </a>

  <a class="py-3 navigation-link pointer list-group-item list-group-item-action d-flex justify-content-between align-items-center"
     data-bs-toggle="tab"
     data-bs-target="#v-combat"
     role="tab"
     aria-current="false">
    <div class="d-flex justify-content-center align-items-center">
      <i class="fas fa-fw fa-chess-pawn"></i>
      <span class="ms-3 d-block d-lg-block">{% trans "Combat" %}</span>
    </div>
  </a>

  {% if object.extension_enabled.magic and object.is_magical %}
    <a class="py-3 navigation-link pointer list-group-item list-group-item-action d-flex justify-content-between align-items-center"
       data-bs-toggle="tab"
       data-bs-target="#v-magic"
       role="tab"
       aria-current="false">
      <div class="d-flex justify-content-center align-items-center">
        <i class="gi-lorc-fairy-wand"></i>
        <span class="ms-3 d-block d-lg-block">{% trans "Magic" %}</span>
      </div>
      {% if object.spell_points_available %}
        <span class="badge bg-primary-subtle ms-2">{{ object.spell_points_available }}</span>
      {% endif %}
    </a>
  {% endif %}

  {% if object.extension_enabled.pantheon %}
    <a class="py-3 navigation-link pointer list-group-item list-group-item-action d-flex justify-content-between align-items-center"
       data-bs-toggle="tab"
       data-bs-target="#v-pantheon"
       role="tab"
       aria-current="false">
      <div class="d-flex justify-content-center align-items-center">
        <i class="fas fa-fw fa-ankh"></i>
        <span class="ms-3 d-block d-lg-block">{% trans "Belief" %}</span>
      </div>
      {% if object.grace %}
        <span class="badge bg-primary-subtle ms-2">{{ object.grace }}</span>
      {% endif %}
    </a>
  {% endif %}

  <a class="py-3 navigation-link pointer list-group-item list-group-item-action d-flex justify-content-between align-items-center"
     data-bs-toggle="tab"
     data-bs-target="#v-background"
     role="tab"
     aria-current="false">
    <div class="d-flex justify-content-center align-items-center">
      <i class="fas fa-fw fa-graduation-cap"></i>
      <span class="ms-3 d-block d-lg-block">{% trans "Background" %}</span>
    </div>
  </a>

  <a class="py-3 navigation-link pointer list-group-item list-group-item-action d-flex justify-content-between align-items-center"
     data-bs-toggle="tab"
     data-bs-target="#v-notes"
     role="tab"
     aria-current="false">
    <div class="d-flex justify-content-center align-items-center">
      <i class="fas fa-fw fa-feather"></i>
      <span class="ms-3 d-block d-lg-block">{% trans "Notes" %}</span>
    </div>
    {% if may_edit %}
      <button type="button" class="btn btn-sm ms-2 sidebar-trigger"
              data-sidebar-title="{% trans 'Take a note' %}"
              data-sidebar-url="{% url 'characters:xhr_character_sidebar' pk=object.id sidebar_template="createnote" %}">
        +
      </button>
    {% endif %}
  </a>
</div>

<div class="list-group mb-3">
  <span class="list-group-item py-3 sidebar-trigger"
        data-sidebar-title="{% trans 'Character' %}"
        data-sidebar-url="{% url 'characters:xhr_character_sidebar' pk=object.id sidebar_template="character" %}"
        role="button">

    {% if may_edit %}
      <div class="d-flex align-items-center">
      <i class="fas fa-fw fa-pen"></i>
      <span class="ms-3 d-block d-lg-block">{% trans "Edit / Download" %}</span>
    </div>
    {% else %}
      <div class="d-flex align-items-center">
      <i class="fas fa-fw fa-pen"></i>
      <span class="ms-3 d-block d-lg-block">{% trans "Download" %}</span>
    </div>
    {% endif %}
    </span>
</div>

