{% extends 'characters/fragments/fragment_base.html' %}
{% load characters_extras rules_extras i18n %}

{% block fragment %}
<div class="row">
    <div class="col-12 col-xl-9 mb-4">
        <div class="table-responsive">
            <table class="table table-hover">
                <thead>
                <tr>
                    <th>
                        {% trans 'Action' %}<br>
                    </th>
                    <th class="text-end">
                        <small>{% trans 'Attack Dice' %}</small>
                    </th>
                    <th class="text-end">
                        <small>{% trans 'Penetration' %}</small>
                    </th>
                    <th class="text-end">
                        {% trans 'Bonus Wounds' %}<br>
                    </th>
                    <th class="text-end">
                        {% trans 'Range' %}<br>
                    </th>
                </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>
                            <i class="fas fa-hand-rock text-success"></i> {% trans 'Weaponless' %}<br>
                            <small>{% trans 'Melee' %}</small>
                        </td>
                        <td class="text-end">
                            {% trans 'Weaponless Attack' %} {% color_value_span object.weaponless_attack_dice 6 %} <i class="fas text-muted fa-dice-five"></i>
                        </td>
                        <td class="text-end">
                            {% color_value_span 0 3 %}
                        </td>
                        <td class="text-end">
                            {% for i in object.weaponless_bonus_wounds|to_range %}
                                <i class="fas fa-heart text-danger"></i>
                            {% endfor %}
                        </td>
                        <td class="text-end">
                            1m
                        </td>
                    </tr>
                {% for w in object.characterweapon_set.all %}
                    <tr>
                        <td>
                            <i class="fas fa-hand-rock text-success"></i> {{ w.weapon }}<br>
                            <small>{{ w.weapon.type }}</small>
                        </td>
                        <td class="text-end">
                            {% for am in w.attack_modes %}
                                {{ am.0 }} {% color_value_span am.1 7 %} <i class="fas text-muted fa-dice-five"></i><br>
                            {% endfor %}
                        </td>
                        <td class="text-end">
                            {% color_value_span w.modified_penetration 3 %}
                        </td>
                        <td class="text-end">
                            {% for i in w.modified_wounds|to_range %}
                                <i class="fas fa-heart text-danger"></i>
                            {% endfor %}
                            <br>
                        </td>
                        <td class="text-end">
                            {{ w.weapon.range_meter }}m
                        </td>
                    </tr>
                {% endfor %}
                {% for i in object.characteritem_set.usable_in_combat %}
                    <tr>
                        <td>
                            <i class="fas fa-bomb text-success"></i> <span class="text-muted">{{ i.quantity }} x </span>{{ i.item }}<br>
                            <small>{{ i.item.type }}</small>
                        </td>
                        <td class="text-end">
                            {% color_value_span i.use_roll 7 %}+
                        </td>
                        <td class="text-end">
                        </td>
                        <td class="text-end">
                        </td>
                        <td class="text-end">
                        </td>
                    </tr>
                {% endfor %}
                {% for s in object.characterspell_set.all %}
                    <tr>
                        <td>
                            <i class="fas fa-magic text-danger"></i> {{ s.spell }}<br>
                            <small>{{ s.spell.type.name }} - {{ s.spell.flavour.name }}</small>
                        </td>
                        <td class="text-end">
                            {% color_value_span 4 4 %}+<br>
                            <small>{% color_value_span s.spell.casting_time 1 %}</small>
                        </td>
                        <td class="text-end">
                            {{ s.spell.power }}<br>
                            <small>{{ s.spell.components }}</small>
                        </td>
                        <td class="text-end">
                            {{ s.spell.range }}<br>
                            <small>{{ s.spell.area_of_effect }} - {{ s.spell.area_of_effect_range }}</small>
                        </td>
                    </tr>
                {% endfor %}
                <tr>
                    <td colspan="4">
                        <i class="fas fa-user-shield text-warning"></i> {% trans "Walk" %}<br>
                        <small>{% trans 'Movement' %}</small>
                    </td>
                    <td class="text-end">
                        {% color_value_span object.combat_walking_range 4 %} {% trans 'Meter' %}
                    </td>
                </tr>
                <tr>
                    <td colspan="4">
                        <i class="fas fa-user-shield text-warning"></i> {% trans "Run" %}<br>
                        <small>{% trans 'Movement' %}</small>
                    </td>
                    <td class="text-end">
                        {% color_value_span object.combat_running_range 4 %} {% trans 'Meter' %}
                    </td>
                </tr>
                <tr>
                    <td colspan="4">
                        <i class="fas fa-user-shield text-warning"></i> {% trans "Crawl" %}<br>
                        <small>{% trans 'Movement' %}</small>
                    </td>
                    <td class="text-end">
                        {% color_value_span object.combat_crawling_range 4 %} {% trans 'Meter' %}
                    </td>
                </tr>
                <tr>
                    <td colspan="5">
                        <i class="fas fa-user-shield text-warning"></i> {% trans "Change Stance" %}<br>
                        <small>{% trans 'Movement' %}</small>
                    </td>
                </tr>

                </tbody>
            </table>
        </div>
    </div>

    <div class="col-12 col-xl-3">
        <div class="row">
            <div class="col-md-6 col-xl-12">
                <table class="table">
                    <tr>
                        <td>{% trans 'Actions' %}</td>
                        <td class="text-end">{% color_value_span object.actions 6 %}</td>
                    </tr>
                    {% for skill in object.characterskill_set.combat_skills %}
                        <tr>
                            <td>{{ skill.skill }}</td>
                            <td class="text-end">{% color_value_span skill.value 6 %}</td>
                        </tr>
                    {% endfor %}
                    <tr>
                        <td>{% trans 'Quickness' %}</td>
                        <td class="text-end">{% color_value_span object.quickness 6 %}</td>
                    </tr>
                </table>
            </div>

            <div class="col-md-6 col-xl-12">
                <div class="card mb-5">
                    <div class="list-group list-group-flush">
                        <li class="list-group-item">
                            <div class="h4">{% trans "Attack Roll" %}</div>
                            <div class="text-muted ms-4">7 - {% trans 'Skill' %} - {% trans 'Weapon Accuracy' %}</div>
                        </li>
                        <li class="list-group-item">
                            <div class="h4">{% trans 'Cover Roll' %}</div>
                            <div class="text-muted ms-4">
                                4+ - {% trans 'Mostly covered' %}<br>
                                5+ - {% trans 'Half cover or prone' %}<br>
                                6+ - {% trans 'Minimal cover' %}
                            </div>
                        </li>
                        <li class="list-group-item">
                            <div class="h4">{% trans 'Armor roll' %}</div>
                            <div class="text-muted ms-4">
                                7 - {% trans 'Armor value' %} + {% trans 'penetration' %}
                            </div>
                        </li>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

