{% load characters_extras rules_extras i18n thumbnail %}

<script>
    $(function(){
        $('.add-spell-spell-type-card').on('click', function(e){
            let type_id = $(this).data('type-id')
            $('.type-selection').css('display', 'none')
            $(`#spell-selection-${type_id}`).css('display', 'block')
        })

        $('.back-to-school').on('click', function(e){
            $('.spell-selection').css('display', 'none')
            $('.type-selection').css('display', 'block')

        })
    })
</script>

<div class="container type-selection">
    <div class="row">
        <div class="col-12 text-center">
            <h3>{% trans 'Choose a school' %}</h3>
        </div>
    </div>
    <div class="row">
        {% for t in spell_types %}
            {% thumbnail t.image "1024" as img %}
            <div class="col-12 col-md-4">
                <div class="card text-center add-spell-spell-type-card pointer mb-4" data-type-id="{{ t.id }}">
                    <div class="card-body" style="background-image: url({{ img.url }}); background-size: cover">
                        <div class="card-text w-100 p-5">
                            <h5 class="text-center p-0 m-i0">{{ t }}</h5>
                        </div>
                    </div>
                </div>
            </div>
            {% endthumbnail %}
        {% endfor %}
    </div>
</div>

{% for t in spell_types %}
    <div class="container spell-selection" id="spell-selection-{{ t.id }}" style="display: none">
        <div class="row">
            <div class="col-12 text-center">
                <h3>{% trans 'Choose a spell' %}</h3>
                <small class="text-muted back-to-school pointer"><<< {% trans 'Choose another school' %}</small>
            </div>
        </div>
        <div class="row">
            {% for s in t.basespell_set.all %}
                <div class="col-12 col-md-6">
                    <div class="card mt-3">
                        <div class="card-header">
                            <span class="text-muted float-end">{{ s.variant }}</span>
                            {{ s }}
                        </div>
                        <div class="card-body">
                            {% if s.is_ritual %}
                                <span class="text-muted text-center">{% trans 'Ritual' %}</span>
                            {% endif %}
                            <p>
                                {{ s.rules }}
                            </p>
                            <i class="fas fa-eye-slash fa-fw"></i> {% trans 'Power' %}: {% color_value_span s.power 4 %}<br>
                            <i class="fas fa-eye-slash fa-fw"></i> {% trans 'Range' %}: {% color_value_span s.range 4 %}<br>
                            <i class="fas fa-eye-slash fa-fw"></i> {% trans 'Actions' %}: {% color_value_span s.actions 3 invert=True %}<br>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    </div>
{% endfor %}