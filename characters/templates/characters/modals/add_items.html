{% load characters_extras static armory_extras i18n thumbnail %}

<script src="{% static 'js/add_items_weapons.js' %}"></script>

<div class="row">
    <div class="col-12 col-md-4 col-lg-3">
        <div class="input-group input-group-sm mb-3">
            <input type="text" class="form-control search-items-input" placeholder="{% trans 'Search' %}">
            {% if user.is_superuser %}
                <a href="{% url 'admin:armory_item_add' %}" class="btn btn-warning"><i
                        class="fas fa-plus"></i> {% trans 'admin' %}</a>
            {% endif %}
        </div>
        <button
                type="button"
                data-bs-toggle="collapse"
                data-bs-target="#add-item-mobile-nav"
                class="btn btn-secondary btn-add-item-mobile-nav-toggle mb-1 w-100 d-block d-md-none">{% trans 'Categories' %}</button>

        <div class="collapse dont-collapse-md" id="add-item-mobile-nav">
            <ul class="nav nav-pills flex-column" role="tablist">
                {% if homebrew.exists %}
                    <li class="nav-item add-item-nav-item active"
                        id="nav-item-homebrew">
                        <a class="nav-link" href="#i-homebrew" aria-controls="#i-homebrew" role="tab"
                           data-bs-toggle="tab">{% trans "Custom Items" %}</a>
                    </li>
                {% endif %}
                {% for t in item_types %}
                    <li class="nav-item add-item-nav-item {% if forloop.first and not homebrew.exists %}active{% endif %}"
                        id="nav-item-{{ t.id }}">
                        <a class="nav-link" href="#i{{ t.id }}" aria-controls="i{{ t.id }}" role="tab"
                           data-bs-toggle="tab">{{ t }}</a>
                    </li>
                {% endfor %}
            </ul>
        </div>
    </div>

    <div class="col-12 col-md-8 col-lg-9">
        <div class="tab-content">
            {% if homebrew.exists %}
                <div role="tabpanel"
                     data-rel="#nav-item-homebrew"
                     class="tab-pane add-item-tab-pane active"
                     id="i-homebrew">
                    <div class="row masonry-container">
                        {% for item in homebrew %}
                            <div class="col-12 col-md-4">
                                {% item_widget item character=character %}
                            </div>
                        {% endfor %}
                    </div>
                </div>
            {% endif %}

            {% for t in item_types %}
                <div role="tabpanel"
                     data-rel="#nav-item-{{ t.id }}"
                     class="tab-pane add-item-tab-pane {% if forloop.first and not homebrew.exists %}active{% endif %}"
                     id="i{{ t.id }}">
                    <div class="row masonry-container">
                        {% for item in t.item_set.distinct %}
                            {% has_extensions item character.extensions.all as has_extensions %}
                            {% if has_extensions %}
                                <div class="col-12 col-md-4">
                                    {% item_widget item character=character %}
                                </div>
                            {% endif %}
                        {% endfor %}
                    </div>
                </div>
            {% endfor %}
        </div>
    </div>
</div>
